<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>補助教材-数学15</title>
    <link rel="icon" type="image/png" href="https://drive.google.com/uc?id=1gSe-v4qfUHP_vrhCQMg0RSmkOYpbbzT6&png" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://unpkg.com/three@0.146.0/build/three.min.js"></script>
  </head>
  <body style="margin: 0;">
    <div id="setting" align="center">
      <a href="math-15.html">戻る</a>
      <p>
        x軸回転<input type="range" id="x-rotation" min="0" max="6.283" value="0" step="0.001" />
        y軸回転<input type="range" id="y-rotation" min="0" max="6.283" value="0" step="0.001" />
        z軸回転<input type="range" id="z-rotation" min="0" max="6.283" value="0" step="0.001" />
      </p>
      <p>
        折る前<input type="range" id="rotation" min="0" max="1" value="0" step="0.001" />折った後
      </p>
    </div>
    <div>
      <canvas id="canvas"></canvas>
    </div>
    <script>
      window.onload = function() {
        const renderer = new THREE.WebGLRenderer({
          canvas: document.querySelector("#canvas")
        });
        const height = document.documentElement.clientHeight - $("#setting").height();
        const width = document.documentElement.clientWidth;
        renderer.setSize(width, height);
        var scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(45, width / height, 1, 10000);
        camera.position.set(0, 0, 1000);
        const material = new THREE.LineBasicMaterial( { color: 0xffffff } );
        var points = [];
        points.push( new THREE.Vector3( -200, 200, 0 ) );
        points.push( new THREE.Vector3( 0, -200, 0 ) );
        points.push( new THREE.Vector3( 200, 0, 0 ) );
        points.push( new THREE.Vector3( -200, 200, 0 ) );
        points.push( new THREE.Vector3( -200, -200, 0 ) ); // 左下
        points.push( new THREE.Vector3( 0, -200, 0 ) );
        points.push( new THREE.Vector3( 200, -200, 0 ) );  // 右下
        points.push( new THREE.Vector3( 200, 0, 0 ) );
        points.push( new THREE.Vector3( 200, 200, 0 ) );   // 右上
        points.push( new THREE.Vector3( -200, 200, 0 ) );
        var geometry = new THREE.BufferGeometry().setFromPoints( points );
        var line = new THREE.Line( geometry, material );
        scene.add( line );
        tick();

        function tick() {
          requestAnimationFrame(tick);
          theta = -Number($("#rotation").val());
          theta12 = theta*131.6*Math.PI/180;
          theta3 = theta*109.9*Math.PI/180;
          x1 = -Math.cos(theta12)*160-40 ;
          y1 = x1/2 - 100;
          z1 = Math.sin(theta12)*80*Math.sqrt(5);
          x2 = Math.cos(theta12)*80 + 120 ;
          y2 = 2*x2 - 200;
          z2 = Math.sin(theta12)*80*Math.sqrt(5);
          x3 = Math.cos(theta3)*100 + 100;
          y3 = -x3;
          z3 = Math.sin(theta3)*100*Math.sqrt(2);
          points = [];
          points.push( new THREE.Vector3( -200, 200, 0 ) );
          points.push( new THREE.Vector3( 0, -200, 0 ) );
          points.push( new THREE.Vector3( 200, 0, 0 ) );
          points.push( new THREE.Vector3( -200, 200, 0 ) );
          points.push( new THREE.Vector3( x1, y1, z1 ) ); // 左下
          points.push( new THREE.Vector3( 0, -200, 0 ) );
          points.push( new THREE.Vector3( x3, y3, z3 ) );  // 右下
          points.push( new THREE.Vector3( 200, 0, 0 ) );
          points.push( new THREE.Vector3( x2, y2, z2 ) );   // 右上
          points.push( new THREE.Vector3( -200, 200, 0 ) );
          geometry = new THREE.BufferGeometry().setFromPoints( points );
          line = new THREE.Line( geometry, material );
          scene = new THREE.Scene();
          scene.add( line );

          // 箱を回転させる
          line.rotation.x = Number($("#x-rotation").val());
          line.rotation.y = Number($("#y-rotation").val());
          line.rotation.z = Number($("#z-rotation").val());

          // レンダリング
          renderer.render(scene, camera);
        }
      }
    </script>
  </body>
</html>